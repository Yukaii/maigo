#!/bin/bash

# Maigo SSH Wrapper
# This script provides an SSH-like interface for connecting to Maigo TUI

HOST="127.0.0.1"
PORT="2222"

# Parse command line arguments
while [[ $# -gt 0 ]]; do
    case $1 in
        -p)
            PORT="$2"
            shift 2
            ;;
        *)
            # Parse user@host format
            if [[ "$1" == *"@"* ]]; then
                HOST="${1#*@}"
            else
                HOST="$1"
            fi
            shift
            ;;
    esac
done

echo "Connecting to Maigo TUI Server at $HOST:$PORT"
echo "================================================"
echo ""

# Check if server is running
if ! nc -z "$HOST" "$PORT" 2>/dev/null; then
    echo "Error: Cannot connect to Maigo TUI server at $HOST:$PORT"
    echo ""
    echo "Please start the server first:"
    echo "  ./zig-out/bin/maigo tui-server"
    echo ""
    exit 1
fi

echo "Connected! Welcome to Maigo URL Shortener"
echo ""

# Connect using netcat with better terminal handling
exec nc "$HOST" "$PORT"